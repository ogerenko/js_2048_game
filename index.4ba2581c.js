const e=new class{constructor(e){this.initialState=e,this.board=e||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.boardScore=0,this.currentStatus="idle",this.isAbleToMove=!0,this.isGameActive=!1,this.isGameWon=!1,this.isGameLost=!1}moveLeft(){this.isGameActive&&this.moveTo("left")}moveRight(){this.isGameActive&&this.moveTo("right")}moveUp(){this.isGameActive&&this.moveTo("up")}moveDown(){this.isGameActive&&this.moveTo("down")}getScore(){return this.boardScore}getState(){return this.board}getStatus(){switch(!0){case this.isGameWon:this.currentStatus="win";break;case this.isGameLost:this.currentStatus="lose";break;case this.isGameActive:this.currentStatus="playing";break;default:this.currentStatus="idle"}return this.currentStatus}start(){this.isGameActive=!0,this.placeNewCell(),this.placeNewCell()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.boardScore=0,this.isGameActive=!0,this.isGameWon=!1,this.isGameLost=!1,this.placeNewCell(),this.placeNewCell()}placeNewCell(){let e,t;do e=Math.floor(4*Math.random()),t=Math.floor(4*Math.random());while(0!==this.board[e][t])this.board[e][t]=this.createCell()}createCell(){return .1>Math.random()?4:2}moveTo(e){if(!this.isGameActive)return;let t=this.board[0].length,s=JSON.parse(JSON.stringify(this.board)),i=0,r=e=>e[0].map((t,s)=>e.map(e=>e[s])),a=e=>e.map(e=>e.slice().reverse()),o=e=>e.map(e=>{let s=e.filter(e=>0!==e);s=[...Array(t-s.length).fill(0),...s];for(let e=s.length;e>=0;e--)s[e-1]===s[e]&&(s[e-1]*=2,s[e]=0,i+=s[e-1],e--);return[...Array(t-(s=s.filter(e=>0!==e)).length).fill(0),...s]}),l=()=>{for(let e=0;e<4;e++)for(let t=0;t<4;t++)if(0===this.board[e][t])return!1;for(let e=0;e<4;e++)for(let t=0;t<4;t++)if(t<3&&this.board[e][t]===this.board[e][t+1]||e<3&&this.board[e][t]===this.board[e+1][t])return!1;return this.isGameActive=!1,this.isGameLost=!0,!0},h=e=>{if(JSON.stringify(e)!==JSON.stringify(s)){if(this.board=e,s=e,this.board.flat().includes(2048)){this.isGameActive=!1,this.isGameWon=!0,this.getStatus();return}this.placeNewCell(),l()&&(this.isAbleToMove=!1)}};switch(e){case"up":h(r(a(o(a(r(s)))))),this.boardScore+=i;break;case"down":h(r(o(r(s)))),this.boardScore+=i;break;case"right":h(o(s)),this.boardScore+=i;break;case"left":h(a(o(a(s)))),this.boardScore+=i}}},t=document.querySelector(".container"),s=t.querySelector(".button"),i=t.querySelector(".message-start"),r=t.querySelector(".message-lose"),a=t.querySelector(".message-win"),o=t.querySelector(".game-score");function l(){let s=e.getState().flat();t.querySelectorAll(".field-cell").forEach((e,t)=>{let i=e.classList;for(let t of i)"field-cell"!==t&&(i.remove(t),e.textContent="");0!==s[t]&&(e.classList.add(`field-cell--${s[t]}`),e.textContent=s[t])}),o.textContent=e.getScore(),"lose"===e.getStatus()?r.classList.remove("hidden"):"win"===e.getStatus()&&a.classList.remove("hidden")}s.addEventListener("click",()=>{"Start"===s.textContent?(e.start(),s.textContent="Restart",s.classList.add("restart"),s.classList.remove("start")):e.restart(),i.classList.add("hidden"),r.classList.add("hidden"),a.classList.add("hidden"),l()}),document.addEventListener("keydown",t=>{switch(t.key){case"ArrowUp":e.moveUp();break;case"ArrowDown":e.moveDown();break;case"ArrowLeft":e.moveLeft();break;case"ArrowRight":e.moveRight()}l()});
//# sourceMappingURL=index.4ba2581c.js.map
